<?php
/**
 * Plugin Name: CVE-2018-12895 Hotfix
 * Description: Hotfix for file deletion to to code execution vulnerability
 * Version: 1.0.0
 * Author: Bloom User Experience
 * Author URI: https://www.bloom-ux.com
 *
 * More info on:
 * https://nvd.nist.gov/vuln/detail/CVE-2018-12895
 * https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/
 */

 add_filter( 'wp_update_attachment_metadata', function( $data ){
	if ( isset( $data['thumb'] ) ) {
		$data['thumb'] = basename( $data['thumb'] );
	}
	return $data;
 });