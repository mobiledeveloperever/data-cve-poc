id: wp-security-audit-log-detect

info:
  name: WP Security Audit Log Plugin Detection
  author: windz3r0day
  severity: info
  description: Detects the presence of the WP Security Audit Log plugin and extracts its version.
  tags: wordpress, plugin, wp-security-audit-log

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-security-audit-log/readme.txt"
      - "{{BaseURL}}/wp-content/plugins/wp-security-audit-log/changelog.txt"
      - "{{BaseURL}}/wp-content/plugins/wp-security-audit-log/wp-security-audit-log.php"

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "WP Security Audit Log"
          - "Stable tag: "
        part: body

      - type: regex
        regex:
          - "Version:\\s*([0-9\\.]+)"
        part: body
        name: version

    extractors:
      - type: regex
        name: version
        regex:
          - "Version:\\s*([0-9\\.]+)"

