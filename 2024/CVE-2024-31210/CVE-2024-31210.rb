require 'net/http'
require 'uri'

def check_vulnerability(url)
  uri = URI.parse(url)
  http = Net::HTTP.new(uri.host, uri.port)
  http.use_ssl = true if uri.scheme == 'https'

  # Set up the request
  request = Net::HTTP::Get.new(uri.request_uri, {
    'User-Agent' => 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 Safari/605.1.15',
    'Accept' => '*/*'
  })

  response = http.request(request)

  # Check the response
  if response.body.include?('WordPress 6.4 was detected')
    puts "Vulnerability detected at #{url}"
  else
    puts "No vulnerability detected at #{url}"
  end
end

# Get the URL from the user
print "Enter the URL of the WordPress site: "
url = gets.chomp

check_vulnerability(url)
