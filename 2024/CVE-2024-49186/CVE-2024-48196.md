<font style="color:rgb(51, 51, 51);">eyouCMS v1.6.7</font>



Types of vulnerabilities:URL rediction



vulnerabilities details:

![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726222787219-9f2d5402-2cf0-469c-8b1a-f256af1d3997.png)

You can add links in the friendship link module.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726222960532-afd31a1d-bf8e-4db5-b9c3-074e6bc0b322.png)

Web service enabled in virtual machine.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223155172-d2cca453-32d4-4107-81b0-996381f9c09a.png)

The content of the flag.txt file is shown in the above figure.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223059254-d36067e5-cde4-45f9-9b5b-4c25dd32bd7a.png)

Add a friendly link to access virtual machine files.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223101303-62718fd0-c5cf-4d8a-a3a1-f66414a1e013.png)

This friendship link appears on the homepage.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223119590-b89803d2-5566-4393-a4f6-55d693d8773a.png)

After clicking on the friendship link, the virtual machine file was accessed.



The relevant code for adding friendship links can be found in the application/admin/controller/Links. php file.

![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223440411-2b0ae366-7b6f-4bb9-8315-c12343077af1.png)



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223510034-e8c1f098-8405-4f13-a74b-63ca3b37e987.png)

The code only checks whether the URL is empty and format checks before saving it directly to the database, without filtering out malicious request addresses.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1726223564718-a614ff64-b965-4598-bf3b-6e191899169e.png)

You can see the added friendship links in the links table of the database.

