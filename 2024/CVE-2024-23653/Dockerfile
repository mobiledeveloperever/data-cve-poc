FROM golang:1.23.3 AS builder

WORKDIR /go/src/github.com/po3rin/evilerfile
COPY . ./
RUN --mount=type=cache,target=/root/.cache/go-build  CGO_ENABLED=0 go build -o /eviler -tags "v0.0.1" --ldflags "-s -w" ./cmd/eviler

FROM scratch
COPY --from=builder /eviler /bin/eviler
ENTRYPOINT ["/bin/eviler"]
