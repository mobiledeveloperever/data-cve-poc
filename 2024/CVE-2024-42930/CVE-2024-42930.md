Types of vulnerabilities:URL rediction



vulnerabilities details:

![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341190405-d387c5fa-b738-4ee4-8020-780a7071bcd2.png)

There are two ways to obtain the value of the $url variable in the get-btn-back function of the function.php file. One is to obtain the value through the backurl in the GET request. After obtaining the URL, Base64 encoding is performed and then concatenated into the $btd_html variable; Another way is to retrieve the content of the Referer field in the HTTP packet and directly concatenate it into the $btd_html variable. Careful analysis reveals that neither of these methods rigorously checks and filters the obtained URLs, leading to the emergence of vulnerabilities.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341230755-321b7652-e6a9-47b9-8c24-08b4f27ee7cb.png)

![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341376147-69f86115-586e-4c48-ae7e-59dd7647c8c0.png)

This vulnerability occurs in the reply message. After replying to the message, clicking the return button will redirect the page to the message page. When we modify the redirect link to any other website link, the browser will access the modified link.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341259975-51c65af0-11e9-4c1f-9afb-75440a7d5669.png)

This is a normal redirect link.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341310516-b14700da-6e9d-47e0-9899-804054a630d3.png)

We can replace the normally redirected connection with a Base64 encoded connection from another website.



Utilization method 1:

![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341334971-1bffefc5-e22b-4da6-ac16-68956aa7d853.png)

Change the value of the backurl to a Base64 encoded link to another website.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341357290-30a47c8d-6782-407b-aee1-d115d5277525.png)

The modified redirected link can be seen in the response packet.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341413702-18006bad-b361-4932-9a17-a11f744a5193.png)

Browser access to other websites.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341431881-6c57cdfa-61d5-4efa-82ae-c1a58de3f4c0.png)

The browser redirected to another website.



Utilization method 2:

![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341580214-f79467c4-4876-4435-9225-549bb1e6221d.png)

Replace the value of the Referer field in the HTTP packet with a link to another website.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341604626-89f3b9bf-de8a-4759-99a4-df2c3add99bb.png)

The modified redirected link also can be seen in the response packet.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341646102-d08c82c5-72be-4875-af65-dcd55575f298.png)

Browser access to other websites.



![](https://cdn.nlark.com/yuque/0/2024/png/12420811/1722341661830-b7c4563f-1e54-45c9-ba20-275c97dfa2f3.png)

The browser redirected to another website.









