# Vulnerability ######
A notification caused by a NFC tag or QR code containing a phone number in a URI can be used by an unauthenticated person to make a phone call, displaying the full contact name if saved. This does not appear to be the intended behaviour since all similar ways of placing a call require authentication.

# Steps to replicate ###### 
NFC tag

Prerequisites
- iPhone capable of background NFC scanning.
- A 13.56 MHz tag formatted to NDEF containing “tel:+18002752273” without quotes (substitute with any number).

Whilst the lock screen is showing
1. Hold the NFC tag near the top of the iPhone
2. Drag the notification left
3. Tap view
4. Tap the blue phone number.

When device disabled screen is showing
1. Tap emergency
2. Key “*” and tap call
3. Whilst carrier message is showing, hold the NFC tag near the top of the iPhone
4. Drag the notification downwards and tap the blue phone number


###### QR code

Prerequisites
- An iPhone capable of scanning a QR code
- A QR code containing the URI “tel:+18002752273” without quotes (substitute with any number)
Whilst the lock screen is showing
1. Launch camera in photo mode
2. Point at a QR code
3. Pull down notification and tap blue phone number
  
# Impact 
###### NFC method

Devices affected
- iPhone XS
- iPhone XS Max
- iPhone XR
- iPhone 11
- iPhone 11 Pro - Verified working
- iPhone 11 Pro Max
- iPhone SE 2020 - Verified working on software version 14.4
- iPhone 12 Mini
- iPhone 12
-  iPhone 12 Pro - Verified working
-  iPhone 12 Pro Max

The bug gives the attacker dependable access, since it can be utilised on demand whenever the device is in any of these states;
- Lock screen AFU
- Biometrics disabled eg. due to failed attempts or emergency dial
- Disabled for passcode entry

NFC tags can be emulated on many smartphones mitigating the need for a physical tag - this further increases the scope of usability.

###### QR method
- Affects all current iOS devices
- A QR code can be generated on most devices with a browser - Easy to execute with no tools needed

###### Why this matters 
This bug may not seem significant at first however it can be exploited in various ways.
For example, to perform a reverse phone number lookup, to determine wether or not the owner has a specified number saved in their contacts, also obtaining the full name.
Another use might be, quickly obtaining the targets active phone number by calling another phone you have access to.
There is the possibility for this to be further developed into a contact scanning method using scripted tag emulation.
 ⁃ Disabled for passcode entry
  
## Summary ######

A NFC tag or QR code containing the URI tel:+0000000000 triggers a notification which can be used by an unauthenticated user to initiate a call to a specific number.

This works when the device is locked AFU, and using additional steps can be used whilst the device is disabled.

This is not the intended behaviour even AFU, since tapping on the notification in the normal manner would require authentication. I have attached videos to demonstrate first tapping the context menu, then tapping the blue phone number, ie. hyperlink.

## Expected Behaviour ######

- Prompts for password or biometric to place a call when locked AFU
- When device is disabled, no reaction to NFC proximity, particularly when a
carrier request is in progress 

## License ######
Published by Akiva Fordsham with GPLv3 license 
