id: CVE-2024-27198

info:
  name: TeamCity < 2023.11.4 - Authentication Bypass
  author: DhiyaneshDk
  severity: critical
  verified: true
  description: |
    In JetBrains TeamCity before 2023.11.4 authentication bypass allowing to perform admin actions was possible
    Fofa: app="JET_BRAINS-TeamCity"
    ZoomEye: app:"JetBrains TeamCity"
    Shodan: http.component:"teamcity"
  reference:
    - https://mp.weixin.qq.com/s/uTHHxg4bcOltP_C9nZW__Q
    - https://mp.weixin.qq.com/s/tDi0CkhrQaWPt0W7lg4leA
    - https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/
    - https://nvd.nist.gov/vuln/detail/CVE-2024-27198
  tags: cve,cve2024,teamcity,jetbrains,auth-bypass
  created: 2024/03/07

rules:
  r0:
    request:
      method: GET
      path: /login.html
    expression: '"<span class=\"vWord\">Version</span>(.+?)</span>".bmatches(response.body)'
    extractors:
      - type: regex
        extractor:
          ext1: '"<span class=\"vWord\">Version</span>(?P<version>.+?)</span>".bsubmatch(response.body)'
          version: ext1["version"]
  r1:
    request:
      method: GET
      path: /login.html
    expression: versionCompare(string(version),"<","2023.11.4")
expression: r0()
