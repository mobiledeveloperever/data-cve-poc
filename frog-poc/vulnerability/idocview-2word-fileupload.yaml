id: idocview-2word-fileupload

info:
  name: I Doc View /html/2word 任意文件上传漏洞
  author: Wen
  severity: high
  verified: true
  description: |-
    Fofa: title=="在线文档预览 - I Doc View"
  reference:
    - https://mp.weixin.qq.com/s/i7IHgq4fn795NghY-aYg5A
  tags: idocview,fileupload
  created: 2023/12/27

set:
  filename: randomLowercase(6)
rules:
  r0:
    request:
      method: GET
      path: /html/2word?url={{filename}}
    expression: response.status == 200 && response.headers["content-disposition"].icontains(md5(filename))
expression: r0()